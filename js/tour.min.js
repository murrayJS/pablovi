jQuery(document).ready(function(e){function a(){"desktop"==r?window.requestAnimationFrame?window.requestAnimationFrame(o):o():e(".tour-section").find(".full-container").removeAttr("style").find(".half-container").removeAttr("style"),u()}function o(){var i=e(window).scrollTop(),r=e(window).height(),a=e(window).width();e(".tour-section").each(function(){var d,h,o=e(this),l=i-o.offset().top,f=1,u=a/2+"px";l>=-r&&0>=l?(f=1,d=1,u=(.5*a*(-l/r)).toFixed(0)+"px"):l>0&&r>=l?(u="0px",f=(1-l*t/r).toFixed(5),d=(1-l/r).toFixed(5)):-r>l?(f=1,u=a/2+"px",d=1):d=0,h=parseInt(u.replace("px",""))*n/20,c(o.find(".full-container"),f,d);var p=o.is(":nth-of-type(even)")?"-":"+",g=o.is(":nth-of-type(even)")?"+":"-";o.find(".half-container")&&(s(o.find(".half-container").eq(0),p+u,h),s(o.find(".half-container").eq(1),g+u,h)),l>=0&&r>l?o.addClass("is-visible"):o.removeClass("is-visible")})}function s(t,i,r){var a=Math.ceil(Math.abs(i.replace("px","")));a>=e(window).width()/2?r=0:a>20&&(r=n),t.css({"-moz-transform":"translateX("+i+")","-webkit-transform":"translateX("+i+")","-ms-transform":"translateX("+i+")","-o-transform":"translateX("+i+")",transform:"translateX("+i+")","box-shadow":"0px 0px 40px rgba(0,0,0,"+r+")"})}function c(e,t,n){e.css({"-moz-transform":"scale("+t+")","-webkit-transform":"scale("+t+")","-ms-transform":"scale("+t+")","-o-transform":"scale("+t+")",transform:"scale("+t+")",opacity:n})}function l(){i||e(".tour-section.is-visible").next().length>0&&d(e(".tour-section.is-visible").next())}function f(){if(!i){var t=e(".tour-section.is-visible");t.length>0&&e(window).scrollTop()!=t.offset().top?d(t):t.prev().length>0&&e(window).scrollTop()==t.offset().top&&d(t.prev(".tour-section"))}}function u(){e(window).scrollTop()<e(window).height()/2?e(".vertical-nav .prev").addClass("inactive"):e(".vertical-nav .prev").removeClass("inactive"),e(window).scrollTop()>e(document).height()-3*e(window).height()/2?e(".vertical-nav .next").addClass("inactive"):e(".vertical-nav .next").removeClass("inactive")}function d(t){i=!0,e("body,html").animate({scrollTop:t.offset().top},500,function(){i=!1})}var t=.3,n=.7,i=!1,r=window.getComputedStyle(document.querySelector("body"),"::before").getPropertyValue("content").replace(/"/g,"").replace(/'/g,"");e(window).on("resize",function(){r=window.getComputedStyle(document.querySelector("body"),"::before").getPropertyValue("content").replace(/"/g,"").replace(/'/g,"")}),a(),e(window).on("scroll",function(){a()}),e(".vertical-nav .prev").on("click",function(){f()}),e(".vertical-nav .next").on("click",function(){l()}),e(document).keydown(function(e){"38"==e.which?(f(),e.preventDefault()):"40"==e.which&&(l(),e.preventDefault())})});
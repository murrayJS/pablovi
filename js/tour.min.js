jQuery(document).ready(function(e){function o(){"desktop"==s?window.requestAnimationFrame?window.requestAnimationFrame(r):r():e(".tour-section").find(".full-container").removeAttr("style").find(".half-container").removeAttr("style"),d()}function r(){var n=e(window).scrollTop(),s=e(window).height(),o=e(window).width();e(".tour-section").each(function(){var u,f,r=e(this),c=n-r.offset().top,l=1,d=o/2+"px";c>=-s&&0>=c?(l=1,u=1,d=(.5*o*(-c/s)).toFixed(0)+"px"):c>0&&s>=c?(d="0px",l=(1-c*t/s).toFixed(5),u=(1-c/s).toFixed(5)):-s>c?(l=1,d=o/2+"px",u=1):u=0,f=parseInt(d.replace("px",""))*i/20,h(r.find(".full-container"),l,u);var p=r.is(":nth-of-type(even)")?"-":"+",m=r.is(":nth-of-type(even)")?"+":"-";r.find(".half-container")&&(a(r.find(".half-container").eq(0),p+d,f),a(r.find(".half-container").eq(1),m+d,f)),c>=0&&s>c?r.addClass("is-visible"):r.removeClass("is-visible")})}function a(t,n,s){var o=Math.ceil(Math.abs(n.replace("px","")));o>=e(window).width()/2?s=0:o>20&&(s=i),t.css({"-moz-transform":"translateX("+n+")","-webkit-transform":"translateX("+n+")","-ms-transform":"translateX("+n+")","-o-transform":"translateX("+n+")",transform:"translateX("+n+")","box-shadow":"0px 0px 40px rgba(0,0,0,"+s+")"})}function h(e,t,i){e.css({"-moz-transform":"scale("+t+")","-webkit-transform":"scale("+t+")","-ms-transform":"scale("+t+")","-o-transform":"scale("+t+")",transform:"scale("+t+")",opacity:i})}function c(){n||e(".tour-section.is-visible").next().length>0&&u(e(".tour-section.is-visible").next())}function l(){if(!n){var t=e(".tour-section.is-visible");t.length>0&&e(window).scrollTop()!=t.offset().top?u(t):t.prev().length>0&&e(window).scrollTop()==t.offset().top&&u(t.prev(".tour-section"))}}function d(){e(window).scrollTop()<e(window).height()/2?e(".vertical-nav .prev").addClass("inactive"):e(".vertical-nav .prev").removeClass("inactive"),e(window).scrollTop()>e(document).height()-3*e(window).height()/2?e(".vertical-nav .next").addClass("inactive"):e(".vertical-nav .next").removeClass("inactive")}function u(t){n=!0,e("body,html").animate({scrollTop:t.offset().top},500,function(){n=!1})}var t=.3,i=.7,n=!1,s=window.getComputedStyle(document.querySelector("body"),"::before").getPropertyValue("content").replace(/"/g,"").replace(/'/g,"");e(window).on("resize",function(){s=window.getComputedStyle(document.querySelector("body"),"::before").getPropertyValue("content").replace(/"/g,"").replace(/'/g,"")}),o(),e(window).on("scroll",function(){o()}),e(".vertical-nav .prev").on("click",function(){l()}),e(".vertical-nav .next").on("click",function(){c()}),e(document).keydown(function(e){"38"==e.which?(l(),e.preventDefault()):"40"==e.which&&(c(),e.preventDefault())})});